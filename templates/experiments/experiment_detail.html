{% extends 'base.html' %}

{% load i18n static %}
{% block wrapper_classes %}{% endblock %}
{% block breadcrumb %}
<li class="active" xmlns="http://www.w3.org/1999/html">{{ object }}</li>
{% endblock %}

{% block content_header %}{{ object }}{% endblock %}
{% block page_header %}{% endblock %}
{% block content %}

<div class="row" id="experiment_row" data-experiment-pk="{{ object.pk }}">
  <div class="col-lg-12">
    <div class="nav-tabs-custom no-bottom-margin">
      <ul class="nav nav-tabs exp-nav" role="tablist">
        <li class="active"><a href="#exp-chat" role="tab" data-toggle="tab"><i class="fa fa-comments"></i> {% trans 'Discussion' %}</a></li>
        <li class=""><a href="#exp-workfow" data-target="#exp-workfow" role="tab" data-toggle="tab"><i class="fa fa-edit"></i> {% trans 'Workflow' %}</a></li>
        <li class=""><a href="#unit-page" data-target="#unit-page" role="tab" data-toggle="tab"><i class="fa fa-cube"></i> {% trans 'Data' %}</a></li>
        <li class=""><a href="#exp-page" data-target="#exp-page" role="tab" data-toggle="tab"><i class="fa fa-eyedropper"></i> {% trans 'Details' %}</a></li>
      </ul>
      <!--</div>-->
      <div class="tab-content">
        <div class="tab-pane active" id="exp-chat">
          <div class="row">
            <div class="col-lg-12">
              {% include 'comments/comment_form_block.html' with not_collapse="1" %}
            </div>
          </div>
        </div>
        <div class="tab-pane" id="exp-workfow">
          <div class="row">
            <div class="col-lg-12">
              <div style="overflow:hidden">
                <iframe src="http://wooflo.magic60.ru/project/{{ object.wooflo_key}}" width="100%" height="100%">
                  Ваш браузер не поддерживает плавающие фреймы!
                </iframe></div>
            </div>
          </div>
        </div>
        <div class="tab-pane" id="exp-page">
          <div class="row">
            <div class="col-lg-6">
              <div class="nav-tabs-custom">
                <ul class="nav nav-tabs">
                  <li class=""><a href="#exp-info" data-toggle="tab"><i class="fa fa-info"></i> {% trans 'Info' %}</a></li>
                  <li class="active"><a href="#exp-description" data-toggle="tab"><i class="fa fa-file-text-o"></i> {% trans 'Description' %}</a></li>
                </ul>
                <div class="tab-content">
                  <div class="tab-pane" id="exp-info">
                    <div class="list-group">
                    <div class="row">
                      <div class="col-sm-3 title-desc"><br>{% trans 'title'|upper %}</div>
                      <div class="col-sm-9">
                        <ul class="list-group">
                          <li class="list-group-item">{{ object.title }}</li>
                        </ul>
                      </div>
                      <div class="col-sm-3 title-desc">{% trans 'date'|upper %}</div>
                      <div class="col-sm-9">
                        <ul class="list-group">
                          <li class="list-group-item list-group-item-sm">{{ object.start|date:"m/d/Y H:i" }} -
                            {{ object.end|date:"m/d/Y H:i" }}</li>
                        </ul>
                      </div>
                      <div class="col-sm-3 title-desc">{% trans 'status'|upper %}</div>
                      <div class="col-sm-9">
                        <ul class="list-group">
                          <li class="list-group-item list-group-item-sm">{{ object.get_status_display }}</li>
                        </ul>
                      </div>
                      <div class="col-sm-3 title-desc">{% trans 'owners'|upper %}</div>
                      <div class="col-sm-9">
                        <ul class="list-group">
                          {% for member in object.owners %}
                          <li class="list-group-item list-group-item-sm">
                            <a href="{{ member.get_absolute_url }}">{{ member.full_name }}</a>
                          </li>
                          {% endfor %}
                          {% if not object.owners %}
                          <li class="list-group-item">&nbsp;</li>
                          {% endif %}
                        </ul>
                      </div>
                      <div class="col-sm-3 title-desc external-event">{% trans 'editors'|upper %}</div>
                      <div class="col-sm-9">
                        <ul class="list-group">
                          {% for member in object.editors %}
                          <li class="list-group-item list-group-item-sm"><a
                                  href="{{ member.get_absolute_url }}">{{ member.full_name }}</a></li>
                          {% endfor %}
                          {% if not object.editors %}
                          <li class="list-group-item list-group-item-sm">&nbsp;</li>
                          {% endif %}
                        </ul>
                      </div>
                      <div class="col-sm-3 title-desc">{% trans 'viewers'|upper %}</div>
                      <div class="col-sm-9">
                        <ul class="list-group">
                          {% for member in object.viewers %}
                          <li class="list-group-item list-group-item-sm"><a
                                  href="{{ member.get_absolute_url }}">{{ member.full_name }}</a></li>
                          {% endfor %}
                          {% if not object.viewers %}
                          <li class="list-group-item list-group-item-sm">&nbsp;</li>
                          {% endif %}
                        </ul>
                      </div>
                      <div class="col-sm-9">
                        {% if is_member or is_owner %}
                          <div class="btn-group">
                            <a href="{% url 'experiments:update' pk=object.pk lab_pk=object.lab.pk %}" class="btn btn-info btn-sm btn-flat">
                              <i class="fa fa-edit"></i> {% trans 'edit'|upper %}
                            </a>
                          </div>
                        {% endif %}
                        {% if is_owner %}
                          <div class="btn-group">
                            <a class="btn btn-danger btn-sm btn-flat"
                               data-href="{% url 'experiments:delete' pk=object.pk lab_pk=object.lab.pk %}"
                               data-toggle="modal" data-target="#confirm-delete" href="#">
                              <i class="fa fa-trash-o"></i> {% trans 'delete'|upper %}</a>
                          </div>
                        {% endif %}
                      </div>
                    </div>
                  </div>
                  </div>
                  <div class="tab-pane active" id="exp-description">
                    {{ object.description|safe }}
                  </div>
                </div>
              </div>
            </div>
            <div class="col-lg-6">
              <div class="nav-tabs-custom">
                <ul class="nav nav-tabs">
                  <li class="active"><a href="#all" data-toggle="tab"><i class="fa fa-history"></i> {% trans 'All' %}</a></li>
                  <!--<li class="active">-->
                    <!--<a href="#comments_activities" data-toggle="tab"><i class="fa fa-comments"></i> {% trans 'Comments' %}</a>-->
                  <!--</li>-->
                </ul>
                <div class="tab-content">
                  <div class="tab-pane" id="all"
                       data-url="{% url 'dashboard:experiment-all-activity' lab_pk=lab.pk experiment_pk=object.pk %}">
                  </div>
                  <!-- /.tab-pane -->
                  <!--<div class="tab-pane active" id="comments_activities">-->

                  <!--</div>-->
                  <!-- /.tab-pane -->
                </div>
                <!-- /.tab-content -->
              </div>
            </div>
          </div>
        </div>

        <div class="tab-pane" id="unit-page">
          <div class="row">
            <div class="col-lg-6">
              <div class="nav-tabs-custom">
                <ul class="nav nav-tabs">
                  <li class=""><a href="#units-graph" data-toggle="tab"><i class="fa fa-pie-chart"></i>  {% trans 'Graph' %}</a></li>
                  <li class="">
                    <a href="#units-list" data-toggle="tab"><i class="fa fa-list"></i> {% trans 'List' %}</a>
                  </li>
                  <li class="pull-right" ><a class="create-unit" data-url="{% url 'units:create' lab.pk %}" href="#"><i class="fa fa-plus"></i> {% trans "Create Unit" %}</a></li>
                  <li class="pull-right" style="margin-right: -20px;"><a data-toggle="modal" data-target="#add_unit" href="#"><i class="fa fa-plus"></i> {% trans "Add Unit" %}</a></li>
                  {% include "units/unit_add_modal.html" %}
                </ul>

                <div class="tab-content">
                  <div class="tab-pane active" id="units-graph">
                    <!--<a href="{% url 'units:create' lab.pk %}" class="btn btn-primary">Add Unit</a>-->
                    <div class="graph-area" data-graph-json='{{ units_graph_json }}'></div>
                  </div>
                  <!-- /.tab-pane -->
                  <div class="tab-pane" id="units-list">
                    <ul class="list-group">
                        {% for unit in units %}
                          <a href="#" data-unit-pk="{{ unit.pk }}" onclick="return false;" class="list-group-item list-group-item-sm unit-item">{{ unit }}</a>
                        {% endfor %}
                    </ul>
                    <div class="btn-group">
                      <a href="{% url 'units:experiment_unit_list' lab_pk=object.lab.pk experiment_pk=object.pk %}"
                         class="btn bg-yellow btn-sm">
                        <i class="fa fa-list"></i> {% trans 'edit units list'|upper %}
                      </a>
                    </div>
                  </div>
                  <!-- /.tab-pane -->
                </div>
                <!-- /.tab-content -->
              </div>
            </div>

            <div class="col-lg-6">
              <div class="nav-tabs-custom unit-tabs">
                <ul class="nav nav-tabs">
                  <li class="active"><a href="#unit-desc" data-toggle="tab"><i class="fa fa-file-text-o"></i> {% trans 'Description' %}</a></li>
                  <li class=""><a href="#unit-measurements" data-toggle="tab"><i class="fa fa-table"></i> {% trans 'Measurements' %}</a></li>
                  <li class=""><a href="#unit-tags" data-toggle="tab"><i class="fa fa-tag"></i> {% trans 'Tags' %}</a></li>
                  <li class=""><a href="#unit-comments" data-toggle="tab"><i class="fa fa-comments"></i> {% trans 'Comments' %}</a></li>
                </ul>
                <div class="tab-content">
                  <div class="tab-pane active" id="unit-desc">
                    <div class="desc-area"></div>
                    <!--<a style="display:none" class="btn btn-primary edit-unit">Edit</a>-->
                  </div>

                  <div class="tab-pane"  id="unit-measurements">
                    <div class="btn-group">
                      <button style="display:none" id="save" class="btn bg-olive"><i class="fa fa-save"></i> {% trans 'Save' %}</button>
                    </div>
                    <div class="btn-group">
                      <button  style="display:none" class="addcolumn btn bg-olive"><i class="fa fa-plus"></i> {% trans 'Add Column' %}</button>
                    </div>
                    <div class="btn-group">
                      <button  style="display:none" class="show-plot btn bg-olive"><i class="fa fa-area-chart"></i> {% trans 'Create plot' %}</button>
                    </div>
                    <div class="btn-group pull-right">
                      <button style="display:none" type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown">History <span class="caret"></span></button>
                      <ul class="dropdown-menu scrollable-menu revision-list" role="menu"></ul>
                    </div>
                    <div class="plot-area">
                      <div class="voffset1">
                        <form id="plot-form" style="display: none">
                          <div class="plot-link"></div>
                          <div class="form-inline">
                            <div class="form-group">
                              <select  class="form-control asis" name="xasis">
                                <option selected disabled>x-asis</option>
                              </select>
                            </div>
                            <div class="form-group">
                              <select class="form-control asis" name="yasis">
                                <option selected disabled>y-asis</option>
                              </select>
                            </div>
                            <div class="form-group">
                              <select  class="input-small form-control" name="type">
                                <option disabled>type</option>
                                <option selected value="scatter">scatter</option>
                                <option value="bar">bar</option>
                              </select>
                            </div>
                          </div>
                          <div class="create-plot-btn">
                            <button class="create-plot btn bg-olive"><i class="fa fa-area-chart"></i> {% trans 'Create plot' %}</button>
                          </div>
                        </form>
                      </div>
                    </div>
                    <div class="top voffset2">
                      <div class="wrap-handsontable">
                        <div id="dataTableEditable" data-content='[[&quot;&quot;, &quot;&quot;], [&quot;&quot;, &quot;&quot;]]'
                             data-title='[[&quot;&quot;, &quot;&quot;], [&quot;&quot;, &quot;&quot;]]'
                             data-column='[[&quot;&quot;, &quot;&quot;], [&quot;&quot;, &quot;&quot;]]'
                             data-url=''
                             data-remove-url=''>

                         </div>
                      </div>
                    </div>
                  </div>

                  <div class="tab-pane" id="unit-tags">
                    <div id="tag-tree" data-content='{{ tags }}'></div>
                    <button style="display:none" id="tag-save" class="btn bg-olive"><i class="fa fa-save"></i> {% trans 'Save' %}</button>
                  </div>

                  <div class="tab-pane" id="unit-comments">
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
    </div>
  </div>
  {% include 'filemanager/angular/modal.html' %}
</div>

{% include 'alert.html' with obj=object.title %}

{% endblock %}


{% block script %}
  {% include 'filemanager/angular/modal_scripts.html' %}
  <script type="text/javascript" src="https://www.dropbox.com/static/api/2/dropins.js" id="dropboxjs" data-app-key="mw4uj2q482bd8w0"></script>
{% endblock %}